/**
 * Minified by jsDelivr using Terser v5.37.0.
 * Original file: /npm/fengari-interop@0.1.3/src/js.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";const{lua:lua,lauxlib:lauxlib,lualib:lualib,to_luastring:to_luastring}=require("fengari"),{LUA_MULTRET:LUA_MULTRET,LUA_OK:LUA_OK,LUA_REGISTRYINDEX:LUA_REGISTRYINDEX,LUA_RIDX_MAINTHREAD:LUA_RIDX_MAINTHREAD,LUA_TBOOLEAN:LUA_TBOOLEAN,LUA_TFUNCTION:LUA_TFUNCTION,LUA_TLIGHTUSERDATA:LUA_TLIGHTUSERDATA,LUA_TNIL:LUA_TNIL,LUA_TNONE:LUA_TNONE,LUA_TNUMBER:LUA_TNUMBER,LUA_TSTRING:LUA_TSTRING,LUA_TTABLE:LUA_TTABLE,LUA_TTHREAD:LUA_TTHREAD,LUA_TUSERDATA:LUA_TUSERDATA,lua_atnativeerror:lua_atnativeerror,lua_call:lua_call,lua_getfield:lua_getfield,lua_gettable:lua_gettable,lua_gettop:lua_gettop,lua_isnil:lua_isnil,lua_isproxy:lua_isproxy,lua_newuserdata:lua_newuserdata,lua_pcall:lua_pcall,lua_pop:lua_pop,lua_pushboolean:lua_pushboolean,lua_pushcfunction:lua_pushcfunction,lua_pushinteger:lua_pushinteger,lua_pushlightuserdata:lua_pushlightuserdata,lua_pushliteral:lua_pushliteral,lua_pushnil:lua_pushnil,lua_pushnumber:lua_pushnumber,lua_pushstring:lua_pushstring,lua_pushvalue:lua_pushvalue,lua_rawgeti:lua_rawgeti,lua_rawgetp:lua_rawgetp,lua_rawsetp:lua_rawsetp,lua_rotate:lua_rotate,lua_setfield:lua_setfield,lua_settable:lua_settable,lua_settop:lua_settop,lua_toboolean:lua_toboolean,lua_tojsstring:lua_tojsstring,lua_tonumber:lua_tonumber,lua_toproxy:lua_toproxy,lua_tothread:lua_tothread,lua_touserdata:lua_touserdata,lua_type:lua_type}=lua,{luaL_argerror:luaL_argerror,luaL_checkany:luaL_checkany,luaL_checkoption:luaL_checkoption,luaL_checkstack:luaL_checkstack,luaL_checkudata:luaL_checkudata,luaL_error:luaL_error,luaL_getmetafield:luaL_getmetafield,luaL_newlib:luaL_newlib,luaL_newmetatable:luaL_newmetatable,luaL_requiref:luaL_requiref,luaL_setfuncs:luaL_setfuncs,luaL_setmetatable:luaL_setmetatable,luaL_testudata:luaL_testudata,luaL_tolstring:luaL_tolstring}=lauxlib,{luaopen_base:luaopen_base}=lualib,FENGARI_INTEROP_VERSION_MAJOR="0",FENGARI_INTEROP_VERSION_MINOR="1",FENGARI_INTEROP_VERSION_NUM=1,FENGARI_INTEROP_VERSION_RELEASE="3",FENGARI_INTEROP_VERSION="0.1",FENGARI_INTEROP_RELEASE="0.1.3";let custom_inspect_symbol;if("undefined"!=typeof process)try{custom_inspect_symbol=require("util").inspect.custom}catch(t){}const global_env="undefined"!=typeof process?global:"undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:(0,eval)("this");let apply,construct,Reflect_deleteProperty;if("undefined"!=typeof Reflect)apply=Reflect.apply,construct=Reflect.construct,Reflect_deleteProperty=Reflect.deleteProperty;else{const t=Function.apply,e=Function.bind;apply=function(e,l,u){return t.call(e,l,u)},construct=function(t,l){switch(l.length){case 0:return new t;case 1:return new t(l[0]);case 2:return new t(l[0],l[1]);case 3:return new t(l[0],l[1],l[2]);case 4:return new t(l[0],l[1],l[2],l[3])}let u=[null];return u.push.apply(u,l),new(e.apply(t,u))},Reflect_deleteProperty=Function("t","k","delete t[k]")}const toString=String.prototype.concat.bind(""),isobject=function(t){return"object"==typeof t?null!==t:"function"==typeof t},js_tname=to_luastring("js object"),js_library_not_loaded="js library not loaded into lua_State",testjs=function(t,e){let l=luaL_testudata(t,e,js_tname);return l?l.data:void 0},checkjs=function(t,e){return luaL_checkudata(t,e,js_tname).data},pushjs=function(t,e){lua_newuserdata(t).data=e,luaL_setmetatable(t,js_tname)},getmainthread=function(t){lua_rawgeti(t,LUA_REGISTRYINDEX,LUA_RIDX_MAINTHREAD);let e=lua_tothread(t,-1);return lua_pop(t,1),e},states=new WeakMap,push=function(t,e){switch(typeof e){case"undefined":lua_pushnil(t);break;case"number":lua_pushnumber(t,e);break;case"string":lua_pushstring(t,to_luastring(e));break;case"boolean":lua_pushboolean(t,e);break;case"symbol":lua_pushlightuserdata(t,e);break;case"function":if(lua_isproxy(e,t)){e(t);break}case"object":if(null===e){if(lua_rawgetp(t,LUA_REGISTRYINDEX,null)!==LUA_TUSERDATA)throw Error(js_library_not_loaded);break}default:{let l=states.get(getmainthread(t));if(!l)throw Error(js_library_not_loaded);let u=l.get(e);u?u(t):(pushjs(t,e),u=lua_toproxy(t,-1),l.set(e,u))}}},atnativeerror=function(t){let e=lua_touserdata(t,1);return push(t,e),1},tojs=function(t,e){switch(lua_type(t,e)){case LUA_TNONE:case LUA_TNIL:return;case LUA_TBOOLEAN:return lua_toboolean(t,e);case LUA_TLIGHTUSERDATA:return lua_touserdata(t,e);case LUA_TNUMBER:return lua_tonumber(t,e);case LUA_TSTRING:return lua_tojsstring(t,e);case LUA_TUSERDATA:{let l=testjs(t,e);if(void 0!==l)return l}default:return wrap(t,lua_toproxy(t,e))}},jscall=function(t,e){let l=lua_pcall(t,e,1,0),u=tojs(t,-1);if(lua_pop(t,1),l===LUA_OK)return u;throw u},invoke=function(t,e,l,u,a){if(!isobject(u))throw new TypeError("`args` argument must be an object");let n=+u.length;n>=0||(n=0),luaL_checkstack(t,2+n,null);let r=lua_gettop(t);e(t),push(t,l);for(let e=0;e<n;e++)push(t,u[e]);if(lua_pcall(t,1+n,a,0)===LUA_OK){let e=lua_gettop(t)-r,l=new Array(e);for(let u=0;u<e;u++)l[u]=tojs(t,r+u+1);return lua_settop(t,r),l}{let e=tojs(t,-1);throw lua_settop(t,r),e}},gettable=function(t){return lua_gettable(t,1),1},get=function(t,e,l){return luaL_checkstack(t,3,null),lua_pushcfunction(t,gettable),e(t),push(t,l),jscall(t,2)},has=function(t,e,l){if(luaL_checkstack(t,3,null),lua_pushcfunction(t,gettable),e(t),push(t,l),lua_pcall(t,2,1,0)===LUA_OK){let e=lua_isnil(t,-1);return lua_pop(t,1),!e}{let e=tojs(t,-1);throw lua_pop(t,1),e}},set=function(t,e,l,u){if(luaL_checkstack(t,4,null),lua_pushcfunction(t,(function(t){return lua_settable(t,1),0})),e(t),push(t,l),push(t,u),lua_pcall(t,3,0,0)!==LUA_OK){let e=tojs(t,-1);throw lua_pop(t,1),e}},deleteProperty=function(t,e,l){if(luaL_checkstack(t,4,null),lua_pushcfunction(t,(function(t){return lua_settable(t,1),0})),e(t),push(t,l),lua_pushnil(t),lua_pcall(t,3,0,0)!==LUA_OK){let e=tojs(t,-1);throw lua_pop(t,1),e}},tostring=function(t,e){return luaL_checkstack(t,2,null),lua_pushcfunction(t,(function(t){return luaL_tolstring(t,1),1})),e(t),jscall(t,1)},iter_next=function(){let t=this.L;luaL_checkstack(t,3,null);let e=lua_gettop(t);if(this.iter(t),this.state(t),this.last(t),lua_pcall(t,2,LUA_MULTRET,0)===LUA_OK){let l;if(this.last=lua_toproxy(t,e+1),lua_isnil(t,-1))l={done:!0,value:void 0};else{let u=lua_gettop(t)-e,a=new Array(u);for(let l=0;l<u;l++)a[l]=tojs(t,e+l+1);l={done:!1,value:a}}return lua_settop(t,e),l}{let e=tojs(t,-1);throw lua_pop(t,1),e}},jsiterator=function(t,e){if(luaL_checkstack(t,1,null),lua_pushcfunction(t,(function(t){return luaL_requiref(t,to_luastring("_G"),luaopen_base,0),lua_getfield(t,-1,to_luastring("pairs")),e(t),lua_call(t,1,3),3})),lua_pcall(t,0,3,0)===LUA_OK){let e=lua_toproxy(t,-3),l=lua_toproxy(t,-2),u=lua_toproxy(t,-1);return lua_pop(t,3),{L:t,iter:e,state:l,last:u,next:iter_next}}{let e=tojs(t,-1);throw lua_pop(t,1),e}},wrap=function(t,e){const l=getmainthread(t);let u=function(){return invoke(l,e,this,arguments,1)[0]};u.apply=function(t,u){return invoke(l,e,t,u,1)[0]},u.invoke=function(t,u){return invoke(l,e,t,u,LUA_MULTRET)},u.get=function(t){return get(l,e,t)},u.has=function(t){return has(l,e,t)},u.set=function(t,u){return set(l,e,t,u)},u.delete=function(t){return deleteProperty(l,e,t)},u.toString=function(){return tostring(l,e)},"function"==typeof Symbol&&(u[Symbol.toStringTag]="Fengari object",u[Symbol.iterator]=function(){return jsiterator(l,e)},Symbol.toPrimitive&&(u[Symbol.toPrimitive]=function(t){if("string"===t)return tostring(l,e)})),custom_inspect_symbol&&(u[custom_inspect_symbol]=u.toString);let a=states.get(l);if(!a)throw Error(js_library_not_loaded);return a.set(u,e),u},jslib={new:function(t){let e=tojs(t,1),l=lua_gettop(t)-1,u=new Array(l);for(let e=0;e<l;e++)u[e]=tojs(t,e+2);return push(t,construct(e,u)),1},tonumber:function(t){let e=tojs(t,1);return lua_pushnumber(t,+e),1},tostring:function(t){let e=tojs(t,1);return lua_pushliteral(t,toString(e)),1},instanceof:function(t){let e=tojs(t,1),l=tojs(t,2);return lua_pushboolean(t,e instanceof l),1},typeof:function(t){let e=tojs(t,1);return lua_pushliteral(t,typeof e),1}};if("function"==typeof Symbol&&Symbol.iterator){const t=function(t,e){let l=checkjs(t,e),u=l[Symbol.iterator];u||luaL_argerror(t,e,to_luastring("object not iterable"));let a=apply(u,l,[]);return isobject(a)||luaL_argerror(t,e,to_luastring("Result of the Symbol.iterator method is not an object")),a},e=function(t){let e=tojs(t,1).next();return e.done?0:(push(t,e.value),1)};jslib.of=function(l){let u=t(l,1);return lua_pushcfunction(l,e),push(l,u),2}}if("function"==typeof Proxy&&"function"==typeof Symbol){const t=Symbol("lua_State"),e=Symbol("fengari-proxy"),l={apply:function(l,u,a){return invoke(l[t],l[e],u,a,1)[0]},construct:function(l,u){let a=l[t],n=l[e],r=u.length;luaL_checkstack(a,2+r,null),n(a);let o=lua_gettop(a);if(luaL_getmetafield(a,o,to_luastring("construct"))===LUA_TNIL)throw lua_pop(a,1),new TypeError("not a constructor");lua_rotate(a,o,1);for(let t=0;t<r;t++)push(a,u[t]);return jscall(a,1+r)},defineProperty:function(l,u,a){let n=l[t],r=l[e];return luaL_checkstack(n,4,null),r(n),luaL_getmetafield(n,-1,to_luastring("defineProperty"))===LUA_TNIL?(lua_pop(n,1),!1):(lua_rotate(n,-2,1),push(n,u),push(n,a),jscall(n,3))},deleteProperty:function(l,u){return deleteProperty(l[t],l[e],u)},get:function(l,u){return get(l[t],l[e],u)},getOwnPropertyDescriptor:function(l,u){let a=l[t],n=l[e];if(luaL_checkstack(a,3,null),n(a),luaL_getmetafield(a,-1,to_luastring("getOwnPropertyDescriptor"))!==LUA_TNIL)return lua_rotate(a,-2,1),push(a,u),jscall(a,2);lua_pop(a,1)},getPrototypeOf:function(l){let u=l[t],a=l[e];return luaL_checkstack(u,2,null),a(u),luaL_getmetafield(u,-1,to_luastring("getPrototypeOf"))===LUA_TNIL?(lua_pop(u,1),null):(lua_rotate(u,-2,1),jscall(u,1))},has:function(l,u){return has(l[t],l[e],u)},ownKeys:function(l){let u=l[t],a=l[e];if(luaL_checkstack(u,2,null),a(u),luaL_getmetafield(u,-1,to_luastring("ownKeys"))===LUA_TNIL)throw lua_pop(u,1),Error("ownKeys unknown for fengari object");return lua_rotate(u,-2,1),jscall(u,1)},set:function(l,u,a){return set(l[t],l[e],u,a),!0},setPrototypeOf:function(l,u){let a=l[t],n=l[e];return luaL_checkstack(a,3,null),n(a),luaL_getmetafield(a,-1,to_luastring("setPrototypeOf"))===LUA_TNIL?(lua_pop(a,1),!1):(lua_rotate(a,-2,1),push(a,u),jscall(a,2))}},u=function(){let t=function(){}.bind();return delete t.length,delete t.name,t};let a=function(){return a=Function("return ()=>void 0;"),a()};const n=function(){let t=a();return delete t.length,delete t.name,t},r=function(a,r,o){const s=getmainthread(a);let _;switch(o){case"function":_=u();break;case"arrow_function":_=n();break;case"object":_={};break;default:throw TypeError("invalid type to createproxy")}return _[e]=r,_[t]=s,new Proxy(_,l)},o=["function","arrow_function","object"],s=o.map((t=>to_luastring(t)));jslib.createproxy=function(t){luaL_checkany(t,1);let e=o[luaL_checkoption(t,2,s[0],s)],l=r(t,lua_toproxy(t,1),e);return push(t,l),1}}let jsmt={__index:function(t){let e=checkjs(t,1),l=tojs(t,2);return push(t,e[l]),1},__newindex:function(t){let e=checkjs(t,1),l=tojs(t,2),u=tojs(t,3);return void 0===u?Reflect_deleteProperty(e,l):e[l]=u,0},__tostring:function(t){let e=checkjs(t,1),l=toString(e);return lua_pushstring(t,to_luastring(l)),1},__call:function(t){let e,l=checkjs(t,1),u=lua_gettop(t)-1,a=new Array(Math.max(0,u-1));if(u>0&&(e=tojs(t,2),u-- >0))for(let e=0;e<u;e++)a[e]=tojs(t,e+3);return push(t,apply(l,e,a)),1},__pairs:function(t){let e,l,u,a,n=checkjs(t,1);if("function"!=typeof Symbol||void 0===(e=n[Symbol.for("__pairs")]))l=function(t){if(this.index>=this.keys.length)return;let e=this.keys[this.index++];return[e,this.object[e]]},u={object:n,keys:Object.keys(n),index:0};else{let r=apply(e,n,[]);void 0===r&&luaL_error(t,to_luastring("bad '__pairs' result (object with keys 'iter', 'state', 'first' expected)")),l=r.iter,void 0===l&&luaL_error(t,to_luastring("bad '__pairs' result (object.iter is missing)")),u=r.state,a=r.first}return lua_pushcfunction(t,(function(){let e=tojs(t,1),u=tojs(t,2),a=apply(l,e,[u]);if(void 0===a)return 0;Array.isArray(a)||luaL_error(t,to_luastring("bad iterator result (Array or undefined expected)")),luaL_checkstack(t,a.length,null);for(let e=0;e<a.length;e++)push(t,a[e]);return a.length})),push(t,u),push(t,a),3},__len:function(t){let e,l,u=checkjs(t,1);return l="function"!=typeof Symbol||void 0===(e=u[Symbol.for("__len")])?u.length:apply(e,u,[]),push(t,l),1}};const luaopen_js=function(t){return states.set(getmainthread(t),new WeakMap),lua_atnativeerror(t,atnativeerror),luaL_newlib(t,jslib),lua_pushliteral(t,"0.1"),lua_setfield(t,-2,to_luastring("_VERSION")),lua_pushinteger(t,1),lua_setfield(t,-2,to_luastring("_VERSION_NUM")),lua_pushliteral(t,"0.1.3"),lua_setfield(t,-2,to_luastring("_RELEASE")),luaL_newmetatable(t,js_tname),luaL_setfuncs(t,jsmt,0),lua_pop(t,1),pushjs(t,null),lua_pushvalue(t,-1),lua_rawsetp(t,LUA_REGISTRYINDEX,null),lua_setfield(t,-2,to_luastring("null")),push(t,global_env),lua_setfield(t,-2,to_luastring("global")),1};module.exports.FENGARI_INTEROP_VERSION="0.1",module.exports.FENGARI_INTEROP_VERSION_NUM=1,module.exports.FENGARI_INTEROP_RELEASE="0.1.3",module.exports.checkjs=checkjs,module.exports.testjs=testjs,module.exports.pushjs=pushjs,module.exports.push=push,module.exports.tojs=tojs,module.exports.luaopen_js=luaopen_js;
//# sourceMappingURL=/sm/3eeb357e9f57a8796b6088682785900d7aa10265adf54e10cc6ceda089ae9492.map